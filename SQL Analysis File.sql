-- Creating the table
create table sales (
	sale_id INT,
	product_id INT,
	customer_id INT,
	sale_date DATE,
	unit_price DECIMAL(8, 2),
	quantity INT
);

-- Inserting values into the sales table
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (20, 17, 4762, '2024/11/16', 72104.65, 14);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (21, 205, 9830, '2024/11/02', 88234.07, 8);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (22, 288, 8390, '2024/11/29', 229683.21, 2);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (23, 261, 8475, '2024/11/17', 262375.87, 1);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (24, 75, 577, '2024/11/13', 40314.27, 2);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (25, 45, 640, '2024/11/05', 62005.29, 9);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (26, 203, 9359, '2024/11/20', 77501.79, 14);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (27, 295, 3978, '2024/11/26', 2410.69, 15);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (28, 285, 3041, '2024/11/04', 83364.08, 5);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (29, 64, 512, '2024/11/01', 12455.8, 13);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (30, 191, 5285, '2024/11/19', 160375.14, 15);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (31, 217, 8650, '2024/11/22', 249245.17, 14);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (32, 63, 7703, '2024/11/21', 50659.53, 2);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (33, 294, 2423, '2024/11/21', 270739.92, 8);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (34, 25, 8304, '2024/11/15', 125993.47, 10);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (35, 223, 5835, '2024/11/23', 181874.49, 8);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (36, 221, 5258, '2024/11/24', 133241.94, 11);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (37, 309, 8513, '2024/11/06', 154001.82, 11);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (38, 183, 5237, '2024/11/05', 95358.71, 5);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (39, 239, 6518, '2024/11/26', 242237.23, 14);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (40, 135, 2246, '2024/11/20', 18161.31, 15);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (41, 51, 5627, '2024/11/12', 217341.13, 10);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (42, 317, 2113, '2024/11/08', 239845.31, 14);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (43, 231, 779, '2024/11/20', 194221.78, 5);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (44, 123, 3927, '2024/11/01', 182272.93, 9);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (45, 220, 1167, '2024/11/01', 62258.73, 9);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (46, 116, 3708, '2024/11/02', 144376.32, 9);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (47, 228, 6957, '2024/11/24', 272529.02, 14);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (48, 132, 9452, '2024/11/13', 9060.51, 13);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (49, 157, 857, '2024/11/03', 191554.04, 10);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (50, 107, 5777, '2024/11/11', 163127.55, 7);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (51, 31, 1496, '2024/11/13', 136159.6, 1);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (52, 5, 9736, '2024/11/14', 4566.68, 7);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (53, 120, 4812, '2024/11/11', 84681.81, 9);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (54, 295, 2662, '2024/11/02', 191266.06, 5);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (55, 21, 1629, '2024/11/18', 57437.93, 14);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (56, 42, 8120, '2024/11/02', 276010.74, 15);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (57, 20, 482, '2024/11/28', 31003.91, 2);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (58, 152, 8472, '2024/11/25', 191680.9, 6);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (59, 64, 3418, '2024/11/16', 183455.66, 11);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (60, 38, 7309, '2024/11/09', 93114.22, 12);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (61, 134, 7271, '2024/11/26', 25655.96, 12);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (62, 102, 9388, '2024/11/13', 34863.65, 14);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (63, 16, 9212, '2024/11/19', 26775.07, 12);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (64, 201, 6157, '2024/11/02', 127838.75, 11);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (65, 172, 7131, '2024/11/14', 120991.66, 2);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (66, 62, 7832, '2024/11/08', 268871.03, 5);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (67, 199, 9416, '2024/11/05', 73291.31, 2);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (68, 241, 3957, '2024/11/19', 77736.33, 8);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (69, 60, 4609, '2024/11/12', 255062.65, 1);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (70, 51, 5603, '2024/11/04', 214012.13, 15);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (71, 228, 675, '2024/11/28', 262760.78, 12);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (72, 46, 9525, '2024/11/01', 84725.57, 12);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (73, 83, 4154, '2024/11/15', 198533.1, 15);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (74, 42, 9283, '2024/11/01', 42896.36, 15);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (75, 186, 9009, '2024/11/14', 168894.9, 14);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (76, 194, 8311, '2024/11/10', 168404.32, 9);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (77, 67, 8592, '2024/11/25', 221936.85, 3);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (78, 27, 2049, '2024/11/11', 100709.69, 7);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (79, 199, 2148, '2024/11/28', 171004.85, 11);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (80, 255, 6664, '2024/11/26', 64353.8, 10);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (81, 225, 6041, '2024/11/14', 39779.83, 7);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (82, 11, 1219, '2024/11/08', 139042.68, 14);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (83, 29, 1459, '2024/11/23', 46324.87, 12);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (84, 197, 9562, '2024/11/08', 20970.33, 4);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (85, 136, 8605, '2024/11/18', 15953.61, 3);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (86, 193, 4996, '2024/11/28', 195222.15, 9);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (87, 240, 3427, '2024/11/01', 202063.74, 6);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (88, 142, 4133, '2024/11/02', 175699.99, 2);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (89, 37, 5982, '2024/11/05', 33773.8, 15);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (90, 54, 4131, '2024/11/05', 159641.09, 15);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (91, 11, 7824, '2024/11/18', 206663.87, 14);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (92, 71, 8330, '2024/11/06', 234640.18, 6);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (93, 47, 9125, '2024/11/05', 111942.17, 10);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (94, 81, 7095, '2024/11/17', 191292.92, 9);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (95, 103, 1090, '2024/11/14', 129302.19, 9);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (96, 48, 3263, '2024/11/09', 240864.33, 8);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (97, 29, 9429, '2024/11/10', 72607.04, 12);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (98, 303, 1723, '2024/11/07', 143125.55, 10);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (99, 117, 2594, '2024/11/11', 59829.42, 7);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (100, 263, 4144, '2024/11/23', 228095.88, 12);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (101, 135, 6903, '2024/11/18', 168509.57, 1);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (102, 195, 139, '2024/11/04', 5057.6, 14);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (103, 112, 8366, '2024/11/02', 65400.5, 15);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (104, 276, 229, '2024/11/04', 26248.78, 11);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (105, 309, 1975, '2024/11/23', 178930.99, 4);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (106, 144, 4056, '2024/11/22', 174957.18, 13);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (107, 142, 9181, '2024/11/20', 110399.79, 6);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (108, 232, 7756, '2024/11/06', 267162.3, 8);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (109, 179, 9710, '2024/11/08', 277920.11, 15);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (110, 300, 8607, '2024/11/03', 140360.6, 11);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (111, 87, 7299, '2024/11/26', 257762.8, 15);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (112, 92, 6557, '2024/11/16', 87644.98, 15);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (113, 185, 7420, '2024/11/18', 260211.78, 7);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (114, 258, 5040, '2024/11/23', 163241.36, 11);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (115, 148, 6908, '2024/11/28', 171450.32, 5);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (116, 71, 1687, '2024/11/06', 105563.49, 6);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (117, 158, 1311, '2024/11/26', 81429.78, 9);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (118, 214, 5386, '2024/11/26', 99590.2, 12);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (119, 73, 8318, '2024/11/24', 21079.3, 3);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (20, 189, 4944, '2024/11/09', 70210.28, 1);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (21, 203, 1496, '2024/11/26', 175277.39, 9);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (22, 153, 940, '2024/11/06', 236044.84, 6);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (23, 160, 1833, '2024/11/23', 135069.05, 10);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (24, 98, 169, '2024/11/15', 234186.35, 8);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (25, 238, 8985, '2024/11/28', 153351.62, 7);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (26, 245, 2719, '2024/11/12', 248445.01, 10);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (27, 315, 9817, '2024/11/20', 148042.78, 9);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (28, 204, 6794, '2024/11/17', 242606.6, 14);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (29, 201, 6856, '2024/11/22', 237095.42, 13);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (30, 154, 1251, '2024/11/14', 146841.24, 15);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (31, 178, 3018, '2024/11/28', 278492.25, 11);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (32, 40, 9987, '2024/11/23', 192520.33, 1);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (33, 301, 5823, '2024/11/22', 262418.75, 15);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (34, 76, 5764, '2024/11/16', 104059.97, 13);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (35, 1, 7749, '2024/11/06', 101481.09, 6);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (36, 7, 1944, '2024/11/05', 19387.39, 8);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (37, 179, 6848, '2024/11/26', 81068.34, 4);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (38, 158, 5408, '2024/11/14', 177222.23, 1);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (39, 232, 3143, '2024/11/13', 2442.61, 1);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (40, 55, 5465, '2024/11/02', 130760.06, 5);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (41, 84, 3477, '2024/11/11', 73772.96, 11);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (42, 210, 8706, '2024/11/07', 276877.54, 10);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (43, 91, 2576, '2024/11/17', 257813.49, 2);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (44, 159, 5580, '2024/11/02', 193908.08, 13);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (45, 268, 9156, '2024/11/20', 103620.04, 12);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (46, 29, 311, '2024/11/01', 259997.72, 8);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (47, 185, 6625, '2024/11/02', 51248.01, 7);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (48, 316, 1814, '2024/11/03', 210044.41, 11);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (49, 233, 7804, '2024/11/13', 43518.35, 5);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (50, 151, 8078, '2024/11/02', 257363.01, 14);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (51, 158, 5196, '2024/11/11', 150828.6, 12);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (52, 25, 4489, '2024/11/12', 100584.36, 7);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (53, 173, 3955, '2024/11/14', 257838.5, 3);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (54, 300, 3838, '2024/11/05', 134623.23, 8);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (55, 9, 8020, '2024/11/13', 107651.02, 4);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (56, 176, 7639, '2024/11/03', 245774.49, 4);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (57, 249, 1661, '2024/11/27', 263953.86, 14);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (58, 156, 7827, '2024/11/29', 177072.98, 12);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (59, 236, 6569, '2024/11/27', 129298.63, 6);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (60, 161, 6533, '2024/11/28', 258024.52, 12);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (61, 132, 2166, '2024/11/13', 167153.07, 11);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (62, 297, 3798, '2024/11/12', 231720.07, 12);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (63, 152, 2451, '2024/11/28', 237814.35, 3);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (64, 126, 8276, '2024/11/28', 101860.66, 7);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (65, 88, 4640, '2024/11/11', 65847.58, 3);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (66, 78, 5003, '2024/11/02', 82372.75, 3);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (67, 136, 8646, '2024/11/06', 66868.81, 9);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (68, 100, 6470, '2024/11/25', 51654.43, 5);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (69, 197, 9497, '2024/11/24', 273051.89, 15);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (70, 105, 3697, '2024/11/21', 223751.84, 7);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (71, 107, 5486, '2024/11/14', 238922.38, 2);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (72, 268, 4163, '2024/11/09', 28275.96, 10);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (73, 95, 3019, '2024/11/02', 193890.03, 3);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (74, 9, 6017, '2024/11/19', 67878.5, 9);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (75, 150, 5747, '2024/11/20', 97395.41, 9);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (76, 190, 6970, '2024/11/04', 49404.79, 2);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (77, 6, 1899, '2024/11/19', 97462.26, 6);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (78, 221, 796, '2024/11/24', 184408.62, 12);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (79, 14, 6027, '2024/11/22', 259893.74, 9);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (80, 222, 7799, '2024/11/11', 242864.58, 4);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (81, 174, 8877, '2024/11/21', 62862.35, 15);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (82, 67, 5987, '2024/11/29', 52651.96, 3);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (83, 305, 674, '2024/11/23', 187850.27, 10);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (84, 60, 3046, '2024/11/11', 247178.03, 10);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (85, 309, 9575, '2024/11/14', 152430.03, 1);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (86, 131, 3283, '2024/11/17', 92318.72, 8);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (87, 117, 8705, '2024/11/11', 100370.74, 5);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (88, 38, 9950, '2024/11/28', 224276.32, 4);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (89, 281, 1259, '2024/11/16', 19267.38, 9);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (90, 46, 7367, '2024/11/09', 44197.62, 9);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (91, 311, 6947, '2024/11/17', 234842.52, 6);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (92, 191, 7447, '2024/11/16', 262787.38, 7);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (93, 173, 8122, '2024/11/08', 97012.59, 1);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (94, 2, 5766, '2024/11/03', 272026.27, 11);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (95, 146, 3653, '2024/11/02', 116756.04, 12);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (96, 149, 3658, '2024/11/05', 91711.69, 14);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (97, 285, 147, '2024/11/23', 96717.87, 3);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (98, 8, 799, '2024/11/25', 6724.1, 15);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (99, 317, 1219, '2024/11/06', 35361.14, 13);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (100, 156, 2485, '2024/11/20', 190005.29, 7);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (101, 237, 7249, '2024/11/12', 85341.89, 15);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (102, 6, 6868, '2024/11/07', 168560.43, 13);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (103, 18, 7101, '2024/11/20', 5496.24, 3);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (104, 85, 1819, '2024/11/09', 118296.07, 14);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (105, 165, 3899, '2024/11/16', 192419.19, 12);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (106, 280, 2147, '2024/11/13', 109292.0, 15);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (107, 144, 3112, '2024/11/06', 231732.57, 6);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (108, 125, 8179, '2024/11/29', 244747.26, 1);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (109, 51, 4608, '2024/11/20', 147688.01, 3);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (110, 181, 2610, '2024/11/06', 207766.71, 4);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (111, 79, 4766, '2024/11/03', 230785.64, 11);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (112, 78, 6072, '2024/11/28', 264019.88, 4);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (113, 235, 8102, '2024/11/07', 11240.01, 3);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (114, 104, 9400, '2024/11/27', 242313.05, 11);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (115, 156, 9966, '2024/11/05', 158446.24, 15);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (116, 61, 7947, '2024/11/28', 49174.37, 9);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (117, 66, 1840, '2024/11/05', 95245.25, 6);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (118, 42, 6757, '2024/11/26', 243448.01, 2);
insert into sales (sale_id, product_id, customer_id, sale_date, unit_price, quantity) values (119, 173, 5302, '2024/11/11', 10340.98, 1);



SELECT 
	COLUMN_NAME,
	DATA_TYPE,
	CHARACTER_MAXIMUM_LENGTH
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'sales';


-- 1
SELECT *
FROM sales;

-- Addition: To retrieve records where quantity_sold and unit_price both exceed their respective  overall averages
SELECT 
	sale_id,	
FROM sales
GROUP BY sale_id
HAVING quantity_sold > (SELECT AVG(quantity_sold) FROM sales)
		AND unit_price > (SELECT AVG(unit_price) FROM sales);

-- 2 Write a query to find all sales where the `Quantity` is greater than 10
SELECT *
FROM sales
WHERE quantity_sold > 10;

SELECT 
	ROUND(AVG(quantity_sold), 2) AS avg_gty_sold,
	MIN(quantity_sold) AS min_qty_sold,
	MAX(quantity_sold) AS max_qty_sold
FROM sales;

-- 3 Write a query to find all sales where the `Quantity` is greater than 10 and the `UnitPrice` is greater than 20
SELECT *
FROM sales
WHERE quantity_sold > 10
  AND unit_price > 20;


-- 4 Write a query to find all sales where the `Quantity` is greater than 10 or the `UnitPrice` is greater than 20
SELECT *
FROM sales
WHERE quantity_sold > 10 
  OR unit_price > 20;

-- 5 Write a query to select all columns from the `Sales` table and order the results by `SaleDate` in ascending order
SELECT *
FROM sales
ORDER BY sale_date ASC;

-- Addition: To get the timespan of the the data in the table
SELECT MAX(sales_date) - MIN(sales_date) AS date_span
FROM sales;

-- 6 Write a query to select all columns from the `Sales` table and order the results by `UnitPrice` in descending order
SELECT * 
FROM sales
ORDER BY unit_price DESC;

-- 7 Write a query to group the sales by `ProductID` and calculate the total quantity sold for each product
SELECT 
	product_id,
	SUM(quantity_sold) AS qty_sold
FROM sales
GROUP BY product_id;

-- 8 Write a query to group the sales by `ProductID` and find products that have sold more than 100 units in total
SELECT 
	product_id,
	SUM(quantity_sold) AS qty_sold
FROM sales
GROUP BY product_id
HAVING SUM(quantity_sold) > 100;

-- 9 Write a query to count the number of sales that occurred for each product
SELECT 
	product_id,
	COUNT(sale_id) AS num_of_sales
FROM sales
GROUP BY product_id;

-- Addition: To count the number of products with total sales < 10
SELECT 
	COUNT(product_id) AS num_of_low_sales_products
FROM 
	(SELECT
		product_id,
		COUNT(sale_id) AS num_of_sales
	 FROM sales
	 GROUP BY product_id
	 HAVING  COUNT(sale_id) < 10);

--Addition: To check if products with total sales < 10 is really an issue in terms of revenue generated
-- Revenue by product_id along with num_of_sales, product_revenue, overall_avg_revenue and overall_median_revenue
 SELECT
	product_id,
	COUNT(sale_id) AS num_of_sales,
	SUM(quantity_sold * unit_price) AS product_revenue,
	  (SELECT ROUND(AVG(quantity_sold * unit_price), 2) AS overall_avg_revenue
	   FROM sales),
	  (SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY quantity_sold * unit_price) AS overall_median_revenue
	   FROM sales)
FROM sales
GROUP BY product_id
ORDER BY num_of_sales ASC;


-- 10 Write a query to calculate the total revenue (Quantity * UnitPrice) for each product
SELECT 
	product_id,
	SUM(quantity_sold * unit_price) AS tot_revenue
FROM sales
GROUP BY product_id;

-- Addition 1 Query to get the top 30 products_ids based on sales count and quantity sold
SELECT 
	product_id,
	COUNT(sale_id) AS num_of_transations,
	SUM(quantity_sold) AS qty_sold,
	SUM(quantity_sold * unit_price) AS tot_revenue
FROM sales
GROUP BY product_id
ORDER BY num_of_transations
LIMIT 30;

-- 11 Write a query to calculate the average `UnitPrice` for each product
SELECT 
	product_id,
	ROUND(AVG(unit_price), 2) AS avg_unit_price
FROM sales
GROUP BY product_id;

-- The data I'm using to work is wrong. Same product shouldn't have varying values as unit_price
SELECT product_id, unit_price
FROM sales
WHERE product_id = 37;

-- 12 Write a query to find the minimum `UnitPrice` for each product
SELECT 
	product_id,
	MIN(unit_price) AS min_unit_price
FROM sales
GROUP BY product_id;

-- 13 Write a query to find the maximum `UnitPrice` for each product
SELECT 
	product_id,
	MAX(unit_price) AS max_unit_price
FROM sales
GROUP BY product_id;

-- 14 Write a query to find all sales where the `Quantity` is greater than 5 and the `SaleDate` is in the year 2023
SELECT *
FROM sales
WHERE quantity_sold > 5 
  AND EXTRACT (YEAR FROM sale_date) = '2023';

-- Addition: To get high quantity or high revenue sales on 22 Nov, the actual Black Friday sales day
SELECT 
	product_id,
	customer_id,
	unit_price,
	quantity_sold,
	(unit_price * quantity_sold) AS revenue
FROM sales
WHERE (quantity_sold >= 10 OR quantity_sold * unit_price >= 1000000)
  AND EXTRACT (DAY FROM sales_date) = 22;

-- Addition: To get the count of transactions and revenue generated for each day of sale
SELECT 
	EXTRACT(DAY FROM sales_date) AS day_of_month,
	COUNT(sale_id) AS num_of_transactions,
	SUM(unit_price * quantity_sold) AS sum_of_revenue
FROM sales
GROUP BY day_of_month
ORDER BY day_of_month;

SELECT 
	sale_id,
	product_id,
	sales_date,
	unit_price,
	quantity_sold,
	unit_price * quantity_sold AS revenue
FROM sales
WHERE EXTRACT(DAY FROM sales_date) = 3
	OR EXTRACT(DAY FROM sales_date) = 22
ORDER BY sales_date DESC, revenue ASC;

SELECT * 
FROM sales
WHERE product_id = 108;

UPDATE sales
SET quantity_sold = 11
WHERE sale_id = 993;

UPDATE sales
SET unit_price = 88538.86
WHERE sale_id = 524;

Select count(sale_id) / 29
FROM sales;

-- Addition 2: Transactions and revenue by DOW
SELECT
	CASE WHEN EXTRACT(DOW FROM sales_date) = 1 THEN 'Monday'
		 WHEN EXTRACT(DOW FROM sales_date) = 2 THEN 'Tuesday'
		 WHEN EXTRACT(DOW FROM sales_date) = 3 THEN 'Wednesday'
	 	 WHEN EXTRACT(DOW FROM sales_date) = 4 THEN 'Thursday'
		 WHEN EXTRACT(DOW FROM sales_date) = 5 THEN 'Friday'
		 WHEN EXTRACT(DOW FROM sales_date) = 6 THEN 'Saturday'
		 ELSE 'Sunday' END AS weekday,
	COUNT(sale_id) AS num_of_transactions,
	SUM(quantity_sold * unit_price) AS total_revenue
FROM sales
GROUP BY weekday
ORDER BY total_revenue DESC, num_of_transactions DESC;

-- Renaming COLUMN TO sales_date
ALTER TABLE sales
RENAME COLUMN sale_date TO sales_date;


-- 15 Write a query to select all columns from the `Sales` table and order the results by `ProductID` and then by `SaleDate` in ascending order
SELECT * 
FROM sales
ORDER BY product_id ASC, sale_date ASC;

-- 16 Write a query to group the sales by `CustomerID` and find customers who have made purchases worth more than $500 in total
SELECT 
	customer_id,
	SUM(quantity_sold * unit_price) AS purchases
FROM sales
GROUP BY customer_id
HAVING SUM(quantity_sold * unit_price) > 500;

-- Addition 3: How often do all customers come to purchase items?
SELECT 
	customer_id,
	COUNT(sale_id) AS frequency_of_purchase
FROM sales
GROUP BY customer_id
ORDER BY frequency_of_purchase DESC;

-- Addition 4: Which customers spent over #5M on purchases?
SELECT 
	customer_id,
	SUM(quantity_sold * unit_price) AS value_of_purchase
FROM sales
GROUP BY customer_id
HAVING SUM(quantity_sold * unit_price) > 5000000;

-- 17 Write a query to group the sales by `ProductID` and count the number of sales for each product where the total number of sales is more than 50  
SELECT 
	product_id,
	COUNT(sale_id) AS num_of_sales
FROM sales 
GROUP BY product_id
HAVING COUNT(sale_id) > 50;

-- 18 Query to calculate the total revenue for sales where the `UnitPrice` is greater than 250000
SELECT
	unit_price,
	SUM(quantity_sold * unit_price)
FROM sales
GROUP BY unit_price
HAVING unit_price > 250000;

-- Addition 5: Query to find products with the least quantity sold by average
-- 19 Write a query to group the sales by `ProductID` and calculate the average `Quantity` sold for each product
SELECT 
	product_id,
	ROUND(AVG(quantity_sold), 2) AS avg_qty_sold
FROM sales
GROUP BY product_id
ORDER BY avg_qty_sold ASC;

-- 20
/* Write a query to select `ProductID`, count the number of sales, 
and calculate the total revenue for each product. 
Only include products that have more than 20 sales 
and order the results by total revenue in descending order */

SELECT
	product_id,
	COUNT(sale_id) AS num_of_sales,
	SUM(quantity_sold * unit_price) AS tot_revenue
FROM sales
GROUP BY product_id
HAVING COUNT(sale_id) > 15
ORDER BY tot_revenue DESC;

